<h1 id="universalapp">UniversalApp</h1>
<h2 id="universal-mobile-app-driven-by-google-sheets">Universal Mobile App driven by Google Sheets</h2>
<p>Monday, 17. April 2017 10:01PM By: Ivo Zivkov, izivkov@gmail.com</p>
<h3 id="introduction">Introduction</h3>
<p>This is a simple hybrid mobile application allowing users to define its functionality by only manipulating its backing Google Spreadsheet. Instead of a traditional database for the back-end, it uses <a href="https://www.google.ca/sheets/about">Google Sheets</a> to store data, content, behaviour and styling information. The app can keep a list of Google Sheets and switch between them, in effect switching to a different app.</p>
<p>Some examples of applications which can be created are:</p>
<ul>
<li>Stock Portfolio</li>
<li>Weather App</li>
<li>Company Web Sites</li>
<li>Various RSS Feeds</li>
</ul>
<p>Here are some screenshots of sample applications which can be created:</p>
<p><img src="imgs/sample-app.png" alt="Drawing" width="200"/> <img src="imgs/sample-app-1.png" alt="Drawing" width="200"/> <img src="imgs/sample-app-2.png" alt="Drawing" width="200"/> <img src="imgs/sample-app-3.png" alt="Drawing" width="200"/></p>
<p>A lot of the logic for the app can be implemented in the Google Sheets through sheet formulas, referring to oher sheets for the data, <a href="https://developers.google.com/apps-script/overview">scripting</a>, etc.</p>
<h3 id="nomenclature">Nomenclature</h3>
<p>Since the app can itself refer to multiple Google Sheets which define apps, the naming could be confusing. We refer to the Google Sheet as &quot;Sheet App&quot;, and the mobile app as just &quot;App&quot;. Similarly, tabs in a Googe Sheet are referred as &quot;Sheet Tab&quot;, and a tab in the mobile app as just &quot;Tab&quot;.</p>
<h3 id="limitations">Limitations</h3>
<p>There is always a balance between flexibility and ease of use. This app is geared toward simplicity, and therefore we have applied some constraints:</p>
<ul>
<li>There is a specific structure: This ia a &quot;tabbed&quot; app with one or more Tabs. The Home screen contain Buttons which bring up Detail screens.</li>
<li>The data is read-only. This means we cannot update the Google Sheets from the app. This was done to simplify end-user permissions.</li>
</ul>
<h3 id="creating-your-own-sheet-app">Creating your own sheet app</h3>
<p>The process is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Use the link below to open our sample Google Sheet and save it to your Google Drive:</p>
<pre><code>https://drive.google.com/open?id=1W0K8HC85gmHvp3fX6eJZCBTL4miTgsLI2ntqW4Sk7ZE</code></pre></li>
</ol>
<div class="figure">
<img src="imgs/20170418-111348.png" />

</div>
<pre><code>    File -&gt; Make a copy</code></pre>
<div class="figure">
<img src="imgs/20170418-112053.png" />

</div>
<p>This will save a new Google Sheet with a name &quot;My App&quot; to your Google Drive, so you can modify it.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Publish your sheet and copy the published URL:</p>
<pre><code>File -&gt; Publish to the web...</code></pre></li>
</ol>
<div class="figure">
<img src="imgs/20170418-112952.png" />

</div>
<p>Copy the link and send it to your mobile device in an email.</p>
<div class="figure">
<img src="imgs/20170418-113225.png" />

</div>
<ol start="3" style="list-style-type: decimal">
<li><p>Now, in the mobile app, go to settings, add a new Sheet App, and paste the URL to connect to your new Google Sheet. This, in effect, will add a new Sheet App to your mobile App.</p></li>
<li><p>Interactively make changes to your Google Sheet and refresh the app the see your changes.</p></li>
</ol>
<h3 id="application-structure">Application Structure</h3>
<p>Although we call this an &quot;Universal App&quot;, it has some specific structure:</p>
<ul>
<li><p>This is a tabbed app - it has one or more tabs, defined in the Google Spreadsheet.</p></li>
<li><p>The first tab is assumed to be a &quot;Home Screen&quot;.</p></li>
<li><p>The Home screen has some buttons, which bring up &quot;Detail Screens&quot;. It can also contain an image.</p></li>
<li><p>Detail screens can contain HTML text, Images and YouTube videos</p></li>
</ul>
<p>Do not confuse Detail screens with Tabs. Tabs top-level screens. Detail screens are pop-ups over the home screen.</p>
<h3 id="the-google-spreadsheet">The Google Spreadsheet</h3>
<p>All this functionality is driven by the backing Google Spreadsheet. Here we describe what this spreadsheet contains:</p>
<p>The Google Sheet contains three Sheet Tabs: <em>app-info</em>, <em>tabs</em> and <em>buttons</em>:</p>
<div class="figure">
<img src="imgs/20170419-115408.png" />

</div>
<p>Each Sheet Tab has some required columns. For example, the <em>buttons</em> Sheet Tab has the columns: <em>name</em>, <em>text</em>, <em>image</em>, <em>video</em>, <em>style</em>, <em>shape</em>, <em>color</em> and <em>size</em>.</p>
<div class="figure">
<img src="imgs/20170419-121259.png" />

</div>
<p>As long as you keep this basic structure, what you put into the spreadsheet is up to you. You can add additionals sheet tabs, add scripting to your sheets, add/remove rows, change text, etc.</p>
<p>Let us go over each of the sheet tabs.</p>
<p><strong>app-info</strong> - Contains general information about the app. It has the following columns:</p>
<ul>
<li><p><em>name</em> - the name of the application, which will appear when we add and display this sheet app in the settings.</p></li>
<li><p><em>author</em> - the author of the sheet app. This will appear in the sheet app's information in the setting.</p></li>
<li><p><em>image</em> - the image to be displayed on this sheet app in the list of sheet apps on the setting screen.</p></li>
<li><p><em>date</em> - when the sheet app was created.</p></li>
<li><p><em>version</em> - the version of the sheet app. Not currently used.</p></li>
</ul>
<p><strong>tabs</strong> - this sheet tab defines the tabs of the app (Home, About, Contact, etc). It contains the following columns:</p>
<ul>
<li><p><em>name</em> - the name of each tab in the mobile app: <em>Home</em>, <em>About</em>. etc. You can add or delete rows to define how many tabs your application will have.</p></li>
<li><p><em>title</em> - The title of the tab, to be displayed on top-left of each tab.</p></li>
<li><p><em>style</em> - currently not used</p></li>
<li><p><em>text</em> - the HTML text we like to put in this tab.</p></li>
<li><p><em>image</em> - image to be displayed in the tab</p></li>
<li><p><em>tabicon</em> - the icon to be shown at the bottom of the screen, corresponding to the tab.</p></li>
<li><p><em>hidden</em> - boolean (yes or no) value to indicate if we like to show or hide that tab. Default to 'no' (do not hide).</p></li>
</ul>
<p><strong>buttons</strong> - defines the buttons on the home tab, and the corresponding detail screens they bring up. It contains the following columns:</p>
<ul>
<li><p><em>name</em> - the name of a button.</p></li>
<li><p><em>text</em> - this is the HTML text to be displayed in the new detail screen which the button will bring up. Note that the text column can contain HTML tags. Also note, that we have the full power of Google Sheets behind us, so the text does not need to be static. It can refer to other columns, and even to other sheet tabs or spreadsheets. You can also use Google API to get information from an outside source or use Google Scripts to provide information. For example, to display the current price of SPY index, you can put the formula:</p>
<pre><code>=&quot;SPY price: &quot; &amp; GOOGLEFINANCE(&quot;SPY&quot;, &quot;price&quot;) &amp; &quot; USD&quot;</code></pre></li>
</ul>
<p>and the values in your app will be updated with the current price.</p>
<ul>
<li><p><em>image</em> - image to be displayed in the Detail page</p></li>
<li><p><em>video</em> - this is an URL of a YouTube video to be shown on the detail screen. To prevent <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a> issues, get the YouTube URL from the embedded code. Right-click on the YouTube video and select &quot;Embedded Code&quot;. Then paste in any editor, and select the URL part only. Should look something like this:</p>
<pre><code>https://www.youtube.com/embed/nDirbacjY</code></pre></li>
<li><p><em>style</em> - this field allows the user to apply CSS style to the button to control appearance and location. For example, if we like a hidden button at a specific location we can add a style like:</p>
<pre><code>{
&quot;position&quot;: &quot;absolute&quot;,
&quot;top&quot;: &quot;15%&quot;,
&quot;left&quot;: &quot;60%&quot;,
&quot;color&quot;:&quot;transparent&quot;
}</code></pre></li>
<li><p><em>shape</em> - the shape of the button. You can select one of: <em>clear</em>, <em>round</em>, <em>full</em>, <em>block</em> and <em>outline</em>.</p></li>
<li><p><em>color</em> - the color of the button. Options are: <em>danger</em>, <em>default</em>, <em>secondary</em>, <em>light</em> and <em>dark</em>.</p></li>
<li><p><em>size</em> - size of the button. Options are: <em>small</em>, <em>default</em> and <em>large</em>.</p></li>
</ul>
<h3 id="settings">Settings</h3>
<p>This page allows the user to select the sheet app to use, add and delete. Each Google Spreadsheet defines a new sheet app.</p>
<div class="figure">
<img src="imgs/20170419-215451.png" />

</div>
<p>When you select one of the sheets apps, the user is taken back to the homepage, with the new screen from the selected sheet app.</p>
<p>To add a new sheet app, copy the spreadsheet published link:</p>
<pre><code>    File -&gt; Publish to web...</code></pre>
<div class="figure">
<img src="imgs/20170419-222112.png" />

</div>
<p>Then in the mobile app, go to Settings and press the <img src="imgs/20170420-211826.png" /> button. A pop-up will appear. Paste the selected link:</p>
<div class="figure">
<img src="imgs/20170419-221309.png" />

</div>
<p>Once you paste the link into the dialog box, the sheet app's image and name will appear (defined in the app-info sheet tab of the spreadsheet):</p>
<div class="figure">
<img src="imgs/20170419-222411.png" />

</div>
<p>Just press the <strong>ADD</strong> button on the dialog and the new sheet app will be added to the list of sheet apps.</p>
<p>To delete a sheet app, long-press on any of the sheets apps in the list, until check-boxes appear on the right. Select the sheet apps you like to delete, and press on the trash can button to delete them. You cannot delete the currently selected sheet app, since you need at least one sheet app to run the mobile app.</p>
<div class="figure">
<img src="imgs/20170419-225234.png" />

</div>
<p><em>Note that you are only deleting references to the spreadsheet from the mobile app, not the actual scpreadsheets.</em></p>
<p>You can also reset the the settings to default by pressing the <img src="imgs/20170420-211724.png" /> button. This will remove all the added apps except the default one.</p>
